

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ansyswrapper.ansyswrapper &mdash; ansyswrapper 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="ansyswrapper 0.1.0 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">ansyswrapper 0.1.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for ansyswrapper.ansyswrapper</h1><div class="highlight"><pre>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;ANSYSWrapperBase&#39;</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">from</span> <span class="nn">openmdao.main.api</span> <span class="kn">import</span> <span class="n">Component</span>
<span class="kn">from</span> <span class="nn">openmdao.main.attrwrapper</span> <span class="kn">import</span> <span class="n">UnitsAttrWrapper</span>
<span class="kn">from</span> <span class="nn">openmdao.lib.datatypes.api</span> <span class="kn">import</span> <span class="n">Float</span>
<span class="kn">from</span> <span class="nn">openmdao.lib.components.api</span> <span class="kn">import</span> <span class="n">ExternalCode</span>
<span class="kn">from</span> <span class="nn">openmdao.util.filewrap</span> <span class="kn">import</span> <span class="n">FileParser</span>

<span class="kn">import</span> <span class="nn">ansysinfo</span>

<span class="c">#ANSYS_VER = &quot;ANSYS140&quot;</span>
<span class="c">#ANSYS_VER = &quot;ANSYS130&quot;</span>

<span class="k">class</span> <span class="nc">ANSYSInstance</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Holds information about an instance to be solved by ANSYS Classical Structural. Only used internally by ANSYSRunner.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">dbfile</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">cdbfile</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">elasticity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">poisson</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbfile</span> <span class="o">=</span> <span class="n">dbfile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cdbfile</span> <span class="o">=</span> <span class="n">cdbfile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elasticity</span> <span class="o">=</span> <span class="n">elasticity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poisson</span> <span class="o">=</span> <span class="n">poisson</span>

    <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;ANSYSInstance &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbfile</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">dbfile &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbfile</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">index &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdbfile</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">cdbfile &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cdbfile</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span>


<span class="k">class</span> <span class="nc">ANSYSRunner</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Runs ANSYS Classical Structural, possibly for multiple instances of ANSYSWrapperBase.</span>
<span class="sd">       There should be only one instance of this class: create it and pass it to the constructor of ANSYSWrapperBase.</span>
<span class="sd">       When finished, the user MUST call shutdown() - it is a good idea to put the call to shutdown in a finally clause.</span>
<span class="sd">       </span>
<span class="sd">       *Parameters*</span>
<span class="sd">       </span>
<span class="sd">           name: string</span>
<span class="sd">               Name used to identify the ANSYSRunner.</span>
<span class="sd">               </span>
<span class="sd">            workingdir: string</span>
<span class="sd">                Full path to directory in which to run ANSYS.</span>
<span class="sd">                </span>
<span class="sd">            timeout: integer (optional)</span>
<span class="sd">                Time to wait for ANSYS commands.  Default 1000.</span>
<span class="sd">                </span>
<span class="sd">            ANSYS_VER: string (optional)</span>
<span class="sd">                ANSYS Version String. Default ANSYS145.</span>
<span class="sd">                </span>
<span class="sd">            run_under_wing: boolean</span>
<span class="sd">                Set to True to if you need to run in a debugger and want to manually start and stop ANSYS. Default False.</span>
<span class="sd">                </span>
<span class="sd">            logger_name:</span>
<span class="sd">                Name of an existing logging::logger to use, if any.  Default None.  If None, a logger will be created with an internal name.</span>
<span class="sd">                </span>
<span class="sd">       &quot;&quot;&quot;</span>
    <span class="n">ansys_instances</span> <span class="o">=</span> <span class="p">{}</span> <span class="c">#empty dictionary #TO_CHECK:  can we assume an order????</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;ANSYSWrapperBase&#39;</span>


    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">workingdir</span><span class="p">,</span> <span class="n">timeout</span> <span class="o">=</span> <span class="s">&#39;1000&#39;</span><span class="p">,</span> <span class="n">ANSYS_VER</span> <span class="o">=</span> <span class="s">&quot;ANSYS145&quot;</span><span class="p">,</span> <span class="n">run_under_wing</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">logger_name</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">logger_name</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;MSI&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">logger_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;ANSYSRunner name must be &lt; 20 characters&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;ANSYSRunner name must be &lt; 20 characters: &#39;</span> <span class="o">+</span>
                                <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workingdir</span> <span class="o">=</span> <span class="n">workingdir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ansys_inited</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ANSYS_VER</span> <span class="o">=</span> <span class="n">ANSYS_VER</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_under_wing</span> <span class="o">=</span> <span class="n">run_under_wing</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">ansysdir</span> <span class="o">=</span>  <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ANSYS_VER</span> <span class="o">+</span> <span class="s">&#39;_DIR&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">ke</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;Cannot find &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ANSYS_VER</span> <span class="o">+</span> <span class="s">&#39;_DIR in environment&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;Cannot find &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ANSYS_VER</span> <span class="o">+</span> <span class="s">&#39;_DIR in environment&#39;</span><span class="p">)</span>
            <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ansysdir2</span> <span class="o">=</span>  <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;ANSYS_SYSDIR&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">ke</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;Cannot find ANSYS_SYSDIR in environment&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;Cannot find ANSYS_SYSDIR in environment&#39;</span><span class="p">)</span>
            <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ansys_exe</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ansysdir</span><span class="p">,</span> <span class="s">&#39;bin&#39;</span><span class="p">,</span> <span class="n">ansysdir2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ANSYS_VER</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">workingdir</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingdir</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">oe</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;Error trying to create workingdir &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">workingdir</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;Error trying to create workingdir &#39;</span> <span class="o">+</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">workingdir</span><span class="p">)</span>
            <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">oe</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ansysfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingdir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;_MSI.dat&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ansysfile</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">ioe</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;Error trying to create file &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansysfile</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;Error trying to create file &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansysfile</span><span class="p">)</span>
            <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">ioe</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hostname</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()</span>
        <span class="n">signame</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="c">#Fix signame so is a legal signal name </span>
        <span class="c">#The signal cannot contain characters other than a-z, A-Z, 0-9 and ASCII characters in the range 128-255</span>
        <span class="n">l1</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s">&#39;Z&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">l2</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">l3</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s">&#39;9&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">l4</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
        <span class="n">l1</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
        <span class="n">l1</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">l3</span><span class="p">)</span>
        <span class="n">l1</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">l4</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span>  <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="n">l1</span><span class="p">:</span>
                <span class="n">signame</span> <span class="o">+=</span> <span class="n">c</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">signame</span> <span class="o">+=</span> <span class="s">&#39;0&#39;</span> <span class="c">#an arbitrary substitution of a legal character</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">from_ansys_signal</span> <span class="o">=</span> <span class="s">&#39;MSI&#39;</span> <span class="o">+</span> <span class="n">signame</span> <span class="o">+</span> <span class="s">&#39;fromansyssignal&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_ansys_signal</span> <span class="o">=</span> <span class="s">&#39;MSI&#39;</span> <span class="o">+</span> <span class="n">signame</span> <span class="o">+</span> <span class="s">&#39;toansyssignal&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ansysout</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingdir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;_MSI.out&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instancefile_basename</span> <span class="o">=</span> <span class="s">&#39;MSI_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;_inst&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instancefile_ext</span> <span class="o">=</span> <span class="s">&#39;txt&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="s">&#39;TO FORCIBLY STOP ANSYS:</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingdir</span><span class="p">,</span> 
                             <span class="bp">self</span><span class="o">.</span><span class="n">instancefile_basename</span> <span class="o">+</span> <span class="s">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">instancefile_ext</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span> <span class="o">+</span> <span class="s">&#39;Put -1 in &#39;</span> <span class="o">+</span> <span class="n">fname</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span> <span class="o">+</span> <span class="s">&#39;then execute</span><span class="se">\n</span><span class="s">WAITFOR /S &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">hostname</span> <span class="o">+</span> \
            <span class="s">&#39; /SI &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_ansys_signal</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="k">print</span> <span class="n">msg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wait_for_ansys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_if_ansys_done</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span> <span class="k">print</span> <span class="s">&#39;before wait, ok &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; timeout &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;before wait_for_ansys, ok &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; timeout &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timeout</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;Not self.ok, not _wait_for_ansys&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Not self.ok, not _wait_for_ansys&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&#39;win32&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="s">&#39;WAITFOR&#39;</span><span class="p">,</span> <span class="s">&#39;/T&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">timeout</span><span class="p">),</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">from_ansys_signal</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span> <span class="k">print</span> <span class="s">&#39;_wait_for_ansys: ret &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;wait_for_ansys ret &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&#39;Error wait for ansys &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_ansys_signal</span>
                <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;Error wait for ansys &#39;</span> <span class="o">+</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">from_ansys_signal</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;Wrong platform&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;wait_for_ansys WRONG PLATFORM&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span> <span class="k">print</span> <span class="s">&#39;after wait&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;after wait_for_ansys, ok &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_signal_ansys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span> <span class="k">print</span> <span class="s">&#39;before send&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;before signal_ansys&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&#39;win32&#39;</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="s">&#39;WAITFOR&#39;</span><span class="p">,</span> <span class="s">&#39;/S&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hostname</span><span class="p">,</span> <span class="s">&#39;/SI&#39;</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">to_ansys_signal</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;Wrong platform&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;signal_ansys WRONG PLATFORM&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span> <span class="k">print</span> <span class="s">&#39;after send&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;after signal_ansys&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_start_ansys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">productvar</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span> <span class="k">print</span> <span class="s">&#39;before start ansys&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;before start_ansys&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ansys_exe</span><span class="p">,</span> <span class="s">&#39;-dir&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">workingdir</span><span class="p">,</span> <span class="s">&#39;-b&#39;</span><span class="p">,</span>
                    <span class="s">&#39;-i&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansysfile</span><span class="p">,</span> <span class="s">&#39;-o&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansysout</span><span class="p">,</span>
                    <span class="s">&#39;-MSI_INSTFILE&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">instancefile_basename</span><span class="p">,</span>
                    <span class="s">&#39;-MSI_INSTEXT&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">instancefile_ext</span><span class="p">]</span>                      
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span> <span class="k">print</span> <span class="n">args</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Starting ANSYS, args: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_under_wing</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ansys_po</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">print</span> <span class="s">&#39;MANUALLY START ANSYS&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ansys_po</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">oe</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;Error trying to start ansys &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_exe</span>
            <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">oe</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;OSError trying to start ansys &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_exe</span> <span class="o">+</span>
                                <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oe</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">return</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c">#import pdb; pdb.set_trace()</span>
            <span class="k">print</span> <span class="s">&#39;Error trying to start ansys &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_exe</span>
            <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;Error trying to start ansys &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_exe</span> <span class="o">+</span>
                                <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_ansys</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
        <span class="c">#import pdb; pdb.set_trace()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span> <span class="k">print</span> <span class="s">&#39;after start ansys&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;after start_ansys&#39;</span><span class="p">)</span>
<span class="c">##        time.sleep(1) #make sure ansys is really ready</span>
<span class="c">##        print &#39;after sleep&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_if_ansys_done</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_check_if_ansys_done</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_under_wing</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;MANUALLY CHECK IF ANSYS RUNNING, if not, set self.ok to False&#39;</span>
            <span class="k">return</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_po</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ret</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span> <span class="c"># has returned</span>
            <span class="k">print</span> <span class="s">&#39;ANSYS exited with retcode &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="o">+</span> \
                  <span class="s">&#39; Probably a licensing issue&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;ANSYS exited with retcode &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="o">+</span> 
                                <span class="s">&#39; Probably a licensing issue&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">_send_index_to_ansys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>
        <span class="n">currdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingdir</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c">#TO_CHECK:  - why????</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_signal_ansys</span><span class="p">()</span> <span class="c">#tell ansys to run instance</span>
                <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="c">#not telling ansys to quit</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_ansys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span> <span class="c">#wait for ansys to run instance</span>
            <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">ioe</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&#39;Error trying to create file &#39;</span> <span class="o">+</span> <span class="n">fname</span>
                <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">ioe</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;Error trying to create file &#39;</span> <span class="o">+</span> <span class="n">fname</span> <span class="o">+</span>
                                    <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ioe</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">currdir</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;After _send_index_to_ansys, ok &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;After _send_index_to_ansys, ok &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">dbfile</span><span class="p">,</span> <span class="n">cdbfile</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">elasticity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">poisson</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Add an instance to be solved by ANSYS Classical Structural.&quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_inited</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;ERROR: attempt to add_instance &#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&#39; after calling init_ansys for ANSYSRunner &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&#39;ERROR: attempt to add_instance &#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&#39; after calling init_ansys for ANSYSRunner &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">return</span> <span class="n">index</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_instances</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;ERROR:&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> \
                  <span class="s">&#39; already used for an ANSYS instance. IGNORED&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;ERROR:&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> 
                                <span class="s">&#39; already used for an ANSYS instance. IGNORED&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ansys_instances</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansys_instances</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ANSYSInstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">dbfile</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">cdbfile</span><span class="p">,</span> <span class="n">elasticity</span><span class="p">,</span> <span class="n">poisson</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;added instance &#39;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">index</span>

    <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;ANSYSRunner &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_inited</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39; ansys_inited&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39; NOT ansys_inited&#39;</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">ansysfile &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansysfile</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">workingdir &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">workingdir</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">ansys_exe &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_exe</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">ansysout  &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansysout</span> 
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">instancefile_basename  &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">instancefile_basename</span> 
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">instancefile_ext  &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">instancefile_ext</span> 
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">signals &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_ansys_signal</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">to_ansys_signal</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Instances:&#39;</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_instances</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">v</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39; NOT OK&#39;</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">init_ansys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prep7</span><span class="o">=</span><span class="p">[],</span> <span class="n">solution</span><span class="o">=</span><span class="p">[],</span> <span class="n">post</span><span class="o">=</span><span class="p">[],</span> <span class="n">productvar</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">timeout</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the ANSYS Mechanical APDL run.  This method should be called AFTER all ansys_instances have been added.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_inited</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;WARNING: attempt to init ANSYS twice for &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span>\
                  <span class="s">&#39; - IGNORED&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;WARNING: attempt to init ANSYS twice for &#39;</span> <span class="o">+</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39; - IGNORED&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/batch</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/TITLE, &#39;</span> <span class="o">+</span> <span class="s">&#39;ANSYSRunner &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>


            <span class="c"># Wrapper will write corresponding instance # (starting at 1)</span>
            <span class="c"># to a file named on the ansys command line</span>
            <span class="c"># Wrapper will write -1 to that file to stop</span>
            <span class="c"># inputs for each instance will be in &lt;instancename&gt;.inp</span>
            <span class="c"># outputs for each instance will be in &lt;instancename&gt;.txt</span>
            <span class="n">numinstance</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ansys_instances</span><span class="p">)</span>

            <span class="n">maxlen</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_instances</span><span class="o">.</span><span class="n">itervalues</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxlen</span><span class="p">:</span> <span class="n">maxlen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">cdbfile</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">cdbfile</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxlen</span><span class="p">:</span> <span class="n">maxlen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">cdbfile</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">dbfile</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dbfile</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxlen</span><span class="p">:</span> <span class="n">maxlen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dbfile</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> <span class="c"># we need to start by making the dbfile, as in CDREAD,DB,&#39;Block01&#39;,&#39;cdb&#39;,,&#39;&#39;,&#39;&#39;</span>
                    <span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">e</span><span class="p">)</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">cdbfile</span><span class="p">)</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">dbfile</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="s">&#39;.db&#39;</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">):</span> <span class="n">e</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>   
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, make db file &#39;</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="s">&#39;.db for &#39;</span> <span class="o">+</span> <span class="n">v</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;CDREAD,DB,&#39;</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="s">&#39;,&#39;</span> <span class="o">+</span> <span class="n">e</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, MATERIAL TYPE INFO</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;MP,EX,1,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">elasticity</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;MP,EY,1,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">elasticity</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;MP,EZ,1,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">elasticity</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;MP, NUXY, 1,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">poisson</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;MP, NUYZ, 1,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">poisson</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;MP, NUXZ, 1,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">poisson</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, save db file &#39;</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="s">&#39;.db for &#39;</span> <span class="o">+</span> <span class="n">v</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;SAVE,&#39;</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="s">&#39;,db</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>  
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, save parameters in &#39;</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="s">&#39;.parms for &#39;</span> <span class="o">+</span> <span class="n">v</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;PARSAVE,ALL,&#39;</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="s">&#39;,parms</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>  
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, clear the database</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/QUIT</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/CLEAR,NOSTART</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, get parameters from &#39;</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="s">&#39;.parms for &#39;</span> <span class="o">+</span> <span class="n">v</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;PARRES,NEW,&#39;</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="s">&#39;,parms</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>  

            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/prep7</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, STRING ARRAY for holding instance info</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="c">#holds name, dbfile name &amp; ext</span>
            <span class="n">instance_info_array</span> <span class="o">=</span> <span class="s">&#39;MSI_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;_iia&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*DIM,&#39;</span> <span class="o">+</span> <span class="n">instance_info_array</span> <span class="o">+</span> <span class="s">&#39;,STRING,&#39;</span> <span class="o">+</span>
                               <span class="nb">str</span><span class="p">(</span><span class="n">maxlen</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">numinstance</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;,3</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_instances</span><span class="o">.</span><span class="n">itervalues</span><span class="p">():</span>
                <span class="n">col</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">instance_info_array</span> <span class="o">+</span>
                                   <span class="s">&#39;(1,&#39;</span> <span class="o">+</span> <span class="n">col</span> <span class="o">+</span> <span class="s">&#39;,1) = </span><span class="se">\&#39;</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">v</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\&#39;\n</span><span class="s">&#39;</span><span class="p">)</span>
                <span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">e</span><span class="p">)</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dbfile</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">):</span> <span class="n">e</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">instance_info_array</span> <span class="o">+</span>
                                   <span class="s">&#39;(1,&#39;</span> <span class="o">+</span> <span class="n">col</span> <span class="o">+</span> <span class="s">&#39;,2) = </span><span class="se">\&#39;</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\&#39;\n</span><span class="s">&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">instance_info_array</span> <span class="o">+</span>
                                   <span class="s">&#39;(1,&#39;</span> <span class="o">+</span> <span class="n">col</span> <span class="o">+</span> <span class="s">&#39;,3) = </span><span class="se">\&#39;</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">e</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\&#39;\n</span><span class="s">&#39;</span><span class="p">)</span>

            <span class="n">instance_var_name</span> <span class="o">=</span> <span class="s">&#39;MSI_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;_ivn&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, array to read instance index from file</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*DIM,&#39;</span> <span class="o">+</span> <span class="n">instance_var_name</span> <span class="o">+</span> <span class="s">&#39;,ARRAY,&#39;</span> <span class="o">+</span> <span class="s">&#39;1</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

            <span class="n">doparm</span> <span class="o">=</span> <span class="s">&#39;MSI_DO_PARM&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">doparm</span> <span class="o">+</span> <span class="s">&#39;=1</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*DOWHILE,&#39;</span> <span class="o">+</span> <span class="n">doparm</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, Signal ANSYSRunner that ANSYS is ready, then wait</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/SYS, C:</span><span class="se">\\</span><span class="s">Windows</span><span class="se">\\</span><span class="s">System32</span><span class="se">\\</span><span class="s">waitfor.exe /S &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">hostname</span> <span class="o">+</span> <span class="s">&#39; /SI &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_ansys_signal</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, Wait for Signal from OpenMDAO</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/SYS, C:</span><span class="se">\\</span><span class="s">Windows</span><span class="se">\\</span><span class="s">System32</span><span class="se">\\</span><span class="s">waitfor.exe /T &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_ansys_signal</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>            
            <span class="n">instfname</span> <span class="o">=</span> <span class="s">&#39;MSI_INSTFILE&#39;</span>
            <span class="n">instename</span> <span class="o">=</span> <span class="s">&#39;MSI_INSTEXT&#39;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, Read instance index from -&#39;</span> <span class="o">+</span> <span class="n">instfname</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span>
                               <span class="n">instename</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*VREAD,&#39;</span> <span class="o">+</span> <span class="n">instance_var_name</span> <span class="o">+</span> <span class="s">&#39;(1),&#39;</span> <span class="o">+</span>
                               <span class="n">instfname</span> <span class="o">+</span> <span class="s">&#39;,&#39;</span> <span class="o">+</span> <span class="n">instename</span>  <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;(F2.0)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;iv=&#39;</span> <span class="o">+</span> <span class="n">instance_var_name</span> <span class="o">+</span> <span class="s">&#39;(1)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;PARSAV,ALL,</span><span class="se">\&#39;</span><span class="s">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\&#39;</span><span class="s">,</span><span class="se">\&#39;</span><span class="s">prm</span><span class="se">\&#39;\n</span><span class="s">&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*IF,iv,LT,0,THEN</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">doparm</span> <span class="o">+</span> <span class="s">&#39;=0</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*ELSE</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;MSI_I_Name = &#39;</span> <span class="o">+</span> <span class="n">instance_info_array</span> <span class="o">+</span>
                               <span class="s">&#39;(1,iv,1)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;finish</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/FILNAME,STRCAT(</span><span class="se">\&#39;</span><span class="s">MSI_ANSYS_</span><span class="se">\&#39;</span><span class="s">,MSI_I_Name),0</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

            <span class="c">#  RESUME IT</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, Resume</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/prep7</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;resume,&#39;</span><span class="o">+</span> <span class="n">instance_info_array</span> <span class="o">+</span> <span class="s">&#39;(1,iv,2), &#39;</span> <span class="o">+</span>
                               <span class="n">instance_info_array</span> <span class="o">+</span> <span class="s">&#39;(1,iv,3)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;allsel</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;PARRES,CHANGE,</span><span class="se">\&#39;</span><span class="s">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\&#39;</span><span class="s">,</span><span class="se">\&#39;</span><span class="s">prm</span><span class="se">\&#39;\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, Read loads, etc.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/INPUT,&#39;</span> <span class="o">+</span> <span class="n">instance_info_array</span> <span class="o">+</span>
                               <span class="s">&#39;(1,iv,1), inp</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">prep7</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">);</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;!finish preprocessing</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;finish</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, Re-solve the model</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/sol</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/INPUT,&#39;</span> <span class="o">+</span> <span class="n">instance_info_array</span> <span class="o">+</span>
                               <span class="s">&#39;(1,iv,1), sol</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/COM, Post-process to get outputs</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;/post1</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;set,first</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">post</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">);</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*cfopen,&#39;</span> <span class="o">+</span> <span class="n">instance_info_array</span> <span class="o">+</span> <span class="s">&#39;(1,iv,1), &#39;</span> <span class="o">+</span>
                               <span class="s">&#39;py</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*vwrite</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;class FeaPropertiesInPythonFormat:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*vwrite</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;	def __init__(self):</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*vwrite</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="n">keylist</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;number&#39;</span><span class="p">,</span> <span class="s">&#39;UX_o&#39;</span><span class="p">,</span> <span class="s">&#39;UY_o&#39;</span><span class="p">,</span> <span class="s">&#39;UZ_o&#39;</span><span class="p">,</span> <span class="s">&#39;UR_o&#39;</span><span class="p">,</span> <span class="s">&#39;TEMP_o&#39;</span><span class="p">,</span> <span class="s">&#39;FX_o&#39;</span><span class="p">,</span> <span class="s">&#39;FY_o&#39;</span><span class="p">,</span> <span class="s">&#39;FZ_o&#39;</span><span class="p">]</span> <span class="c">#these must match ansysinfo.outputtypes keys</span>
            <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">keylist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;		self.nodeLabels = &#39;</span> <span class="o">+</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*vwrite, units</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;		self.units = %I</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*vwrite</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;		self.coordinateSystem = &quot;Cartesian&quot;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*vwrite</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;		self.nodeMap = {</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*get,nComps,COMP,,ncomp</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*do,J,1,nComps,1</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*get,compName,comp,J,name &#39;</span><span class="o">+</span>
                               <span class="s">&#39;! get the name of the nth component</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*get,nType,comp,compName,type &#39;</span> <span class="o">+</span>
                               <span class="s">&#39;! get the type #</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;GETVALS=0</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;allsel</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;cmsel,,compName</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*IF,nType,EQ,1,THEN !type 1 Nodes</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;GETVALS=1</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="c">#self.ansysfd.write(&#39;prnsol,u,comp &#39; + &#39;!not needed but useful for debugging\n&#39;)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*ELSEIF,nType,EQ,6,THEN !type 6 keypoints</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;allsel</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;cmsel,,compName</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;nslk,S</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;GETVALS=1</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*ELSEIF,nType,EQ,8,THEN !type 8 surfaces</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;allsel</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;cmsel,,compName</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;nsla,s,1</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;GETVALS=1</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*ENDIF</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*IF,GETVALS,EQ,1,THEN !get values</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*get,NCOUNT,node,,count &#39;</span> <span class="o">+</span>
                               <span class="s">&#39;! Get total number of selected nodes</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*VWRITE, compName</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;			&quot;</span><span class="si">%s</span><span class="s">&quot;:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*vwrite</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;			[</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*dim,NARRAY,array,NCOUNT,9 &#39;</span> <span class="o">+</span>
                               <span class="s">&#39;! Create NCOUNT x 9 array</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="c">#self.ansysfd.write(&#39;*vwrite ! Writes a column header\n&#39;)</span>
            <span class="c">#self.ansysfd.write(&#39;NODE UX UY UZ TEMP FX FY FZ\n&#39;)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*vget,NARRAY(1,1),node,1,nlist &#39;</span> <span class="o">+</span>
                               <span class="s">&#39;! Fill first column with node number</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*DO,I,1,NCOUNT,1 !loop on nodes</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;N = NARRAY(I,1)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;NARRAY(I,2) = UX(N) &#39;</span> <span class="o">+</span>
                               <span class="s">&#39;! Fill second column with x-displ</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;NARRAY(I,3) = UY(N) &#39;</span> <span class="o">+</span>
                               <span class="s">&#39;! Fill third column with y-displ</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;NARRAY(I,4) = UZ(N) &#39;</span> <span class="o">+</span>
                               <span class="s">&#39;! Fill fourth column with z-displ</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;!We need radial displacement as a signed value</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;rdisp = sqrt(UX(N)**2 + UY(N)**2)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*IF,abs(UX(N)), GT, abs(UY(N)), THEN</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;    rdisp = sign(rdisp, UX(N))</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*else</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;    rdisp = sign(rdisp, UY(N))</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*endif </span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;NARRAY(I,5) = rdisp</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;NARRAY(I,6) = TEMP(N) &#39;</span> <span class="o">+</span>
                               <span class="s">&#39;! Fill sixth column with TEMP</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*GET, NARRAY(I,7), NODE, N, RF, FX&#39;</span> <span class="o">+</span>
                               <span class="s">&#39;! Fill seventh column with X Reaction Load</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*GET, NARRAY(I,8), NODE, N, RF, FY &#39;</span> <span class="o">+</span>
                               <span class="s">&#39;! Fill eighth column with Y Reaction Load</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*GET, NARRAY(I,9), NODE, N, RF, FZ &#39;</span> <span class="o">+</span>
                               <span class="s">&#39;! Fill ninth column with Z Reaction Load</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*ENDDO</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*vwrite,&#39;</span> <span class="o">+</span>
                               <span class="s">&#39;NARRAY(1,1),NARRAY(1,2),NARRAY(1,3),NARRAY(1,4),&#39;</span> <span class="o">+</span>
                               <span class="s">&#39;NARRAY(1,5),NARRAY(1,6),NARRAY(1,7),NARRAY(1,8), NARRAY(1,9)  &#39;</span> <span class="o">+</span>
                               <span class="s">&#39;! Write columns to file</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;			[%I, </span><span class="si">%G</span><span class="s">, </span><span class="si">%G</span><span class="s">, </span><span class="si">%G</span><span class="s">, </span><span class="si">%G</span><span class="s">, </span><span class="si">%G</span><span class="s">, </span><span class="si">%G</span><span class="s">, </span><span class="si">%G</span><span class="s">, </span><span class="si">%G</span><span class="s">,],</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*vwrite</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;			],</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*ENDIF</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*enddo</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*vwrite	</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;			}</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*cfclose</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;finish</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="c">#self.ansysfd.write(&#39;/COM, Signal ANSYSRunner that ANSYS is ready\n&#39;)</span>
            <span class="c">#self.ansysfd.write(&#39;/SYS,WAITFOR /S &#39; + self.hostname +</span>
                <span class="c">#&#39; /SI &#39; + self.from_ansys_signal + &#39;\n&#39;)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*ENDIF</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;*ENDDO</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="c">#self.ansysfd.write(&#39;exit\n&#39;)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansysfd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_start_ansys</span><span class="p">(</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">productvar</span> <span class="o">=</span> <span class="n">productvar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ansys_inited</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;ansys_inited done&#39;</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&#39;ansys_inited done&#39;</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instancename</span><span class="p">,</span> <span class="n">prep7</span><span class="o">=</span><span class="p">[],</span> <span class="n">solution</span><span class="o">=</span><span class="p">[],</span> <span class="n">post</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;Run instancename.  Assumes input file has been written.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;ERROR: in AnsysRunner.</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;ERROR: in AnsysRunner.</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dump</span><span class="p">())</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">instancename</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_instances</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;ERROR: &#39;</span> <span class="o">+</span> <span class="n">instancename</span> <span class="o">+</span> <span class="s">&#39; not in ansys_instances.</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> \
                  <span class="bp">self</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;ERROR: &#39;</span> <span class="o">+</span> <span class="n">instancename</span> <span class="o">+</span>
                                <span class="s">&#39; not in ansys_instances.</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dump</span><span class="p">())</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_inited</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;Calling init_ansys from run&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_ansys</span><span class="p">(</span><span class="n">prep7</span><span class="p">,</span> <span class="n">solution</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&#39;ERROR: in AnsysRunner init_ansys.</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;ERROR: in AnsysRunner  init_ansys.</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">dump</span><span class="p">())</span>
                <span class="k">return</span> <span class="bp">False</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_instances</span><span class="p">[</span><span class="n">instancename</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span> <span class="k">print</span> <span class="s">&#39;Running instance &#39;</span> <span class="o">+</span> <span class="n">instance</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;AnsysRunner start run &#39;</span> <span class="o">+</span> <span class="n">instancename</span><span class="p">)</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instancefile_basename</span> <span class="o">+</span> <span class="s">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">instancefile_ext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_index_to_ansys</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;AnsysRunner after _send_index_to_ansys, ok &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ok</span>

    <span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ansys_inited</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span> <span class="k">print</span> <span class="s">&#39;Shutting down&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;AnsysRunner shutting down&#39;</span><span class="p">)</span>
            <span class="n">fname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instancefile_basename</span> <span class="o">+</span> <span class="s">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">instancefile_ext</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_index_to_ansys</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ansys_inited</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#TO_CHECK:  this doesn&#39;t seem to get called....</span>
        <span class="k">print</span> <span class="s">&#39;DELETING AnsysRunner&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">ANSYSWrapperBase</span><span class="p">(</span><span class="n">ExternalCode</span><span class="p">):</span>
<div class="viewcode-block" id="ANSYSWrapperBase"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase">[docs]</a>    <span class="sd">&quot;&quot;&quot;Base class for wrappers for ANSYS Classical Structural. Used internally by ANSYSWrapperGenerator.&quot;&quot;&quot;</span>
    <span class="n">components</span> <span class="o">=</span> <span class="p">{}</span> <span class="c">#empty dictionary of dictionaries of node numbers</span>
                    <span class="c"># set by subclass when it parses the components file</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">{}</span> <span class="c">#empty dictionary of dictionaries of values</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">runner</span><span class="p">,</span> <span class="n">dbfile</span><span class="p">,</span> <span class="n">cdbfile</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">elasticity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">poisson</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">],</span> <span class="n">logger_name</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ANSYSWrapperBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">logger_name</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;MSI&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">logger_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span> <span class="s">&#39;_&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="n">runner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loadsfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39;.inp&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solutionfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39;.sol&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dbfile</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">cdbfile</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;ERROR:&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&#39; must have one of dbfile or cdbfile. IGNORED&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;ERROR:&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&#39; must have one of dbfile or cdbfile. IGNORED&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dbfile</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deflection_only</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deflection_only</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">add_instance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_name</span><span class="p">,</span> <span class="n">dbfile</span><span class="p">,</span> <span class="n">cdbfile</span><span class="p">,</span> <span class="n">elasticity</span><span class="p">,</span> <span class="n">poisson</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cachefile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">workingdir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39;_cache.txt&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cachefile</span><span class="p">):</span>
                <span class="n">cachepickle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cachefile</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cachepickle</span><span class="p">)</span>
                <span class="n">cachepickle</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">print</span> <span class="s">&#39;ANSYSWrapper &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39; loaded cache &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">cachefile</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dump_cache</span><span class="p">()</span>  
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span> <span class="c">#empty dictionary</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;ANSYSWrapperBase &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dump</span><span class="p">())</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;ANSYS_LOCK&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;OFF&#39;</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;ANS_CONSEC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;YES&#39;</span>


    <span class="k">def</span> <span class="nf">dump_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<div class="viewcode-block" id="ANSYSWrapperBase.dump_cache"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase.dump_cache">[docs]</a>        <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;cache(&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">cachefile</span> <span class="o">+</span> <span class="s">&#39;)</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;: &#39;</span>
            <span class="k">for</span> <span class="n">v1</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">v1</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\t\t</span><span class="s">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;: &#39;</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;...</span><span class="se">\n</span><span class="s">&#39;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="ANSYSWrapperBase.dump"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase.dump">[docs]</a>        <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;ANSYSWrapper &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;index &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;runner name &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;components</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="n">k</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="s">&#39;: &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#39;cache(&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">cachefile</span> <span class="o">+</span> <span class="s">&#39;)</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dump_cache</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="c">#def __setattr__(self, name, value):</span>
        <span class="c">#super(ANSYSWrapperBase, self).__setattr__(name, value)</span>
        <span class="c">## TO_CHECK:  - why did we need this???? self.__dict__[name] = value</span>

    <span class="k">def</span> <span class="nf">_set_value_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lst</span><span class="p">):</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;AnsysWrapper _set_value_list &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; to list of len &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)))</span>
        <span class="n">value_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">lst</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lst</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
            <span class="n">nm</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&#39;_max&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">nm</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="n">value_dict</span><span class="p">[</span><span class="n">nm</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">nm</span> <span class="o">+</span><span class="s">&#39;= &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
            <span class="n">nm</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&#39;_min&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">nm</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="n">value_dict</span><span class="p">[</span><span class="n">nm</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">nm</span> <span class="o">+</span> <span class="s">&#39; = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">lst</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
            <span class="n">nm</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s">&#39;_avg&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">nm</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="n">value_dict</span><span class="p">[</span><span class="n">nm</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">nm</span> <span class="o">+</span><span class="s">&#39; = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">value_dict</span>

    <span class="k">def</span> <span class="nf">get_attr_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">):</span>
<div class="viewcode-block" id="ANSYSWrapperBase.get_attr_value"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase.get_attr_value">[docs]</a>        <span class="n">a</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">UnitsAttrWrapper</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span>

    <span class="k">def</span> <span class="nf">write_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[]):</span></div>
<div class="viewcode-block" id="ANSYSWrapperBase.write_input"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase.write_input">[docs]</a>        <span class="sd">&quot;&quot;&quot;Write input file self.loadsfile.&quot;&quot;&quot;</span>
        <span class="n">currdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">input_cmds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">workingdir</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loadsfile</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">ioe</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&#39;Error opening loadsfile file &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadsfile</span>
                <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">ioe</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39; write input: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadsfile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;-------------------------------------</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="c">#self.logger.debug(&#39;nodeinputtypes &#39; + str(ansysinfo.nodeinputtypes))</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="c">#self.logger.debug(&#39;component &#39; + str(k) + &#39; &#39; + str(vv.keys()))</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">nodes</span> <span class="ow">in</span> <span class="n">vv</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                    <span class="c">#self.logger.debug(name)</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;surfaces&#39;</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ansysinfo</span><span class="o">.</span><span class="n">surfaceinputtypes</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                            <span class="n">n</span> <span class="o">=</span> <span class="n">ansysinfo</span><span class="o">.</span><span class="n">_make_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                            <span class="c">#self.logger.debug(n + &#39; = &#39; + str(v))</span>
                            <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span> <span class="c">#write new value</span>
                                <span class="n">l</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;%N%&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                                <span class="n">l1</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;%V%&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
                                <span class="n">l2</span> <span class="o">=</span> <span class="s">&#39;!apply &#39;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; to &#39;</span> <span class="o">+</span> \
                                    <span class="s">&#39; surface component &#39;</span> <span class="o">+</span> <span class="n">name</span>
                                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">l2</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">l1</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
                                <span class="n">input_cmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;keypoints&#39;</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ansysinfo</span><span class="o">.</span><span class="n">keypointinputtypes</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                            <span class="n">n</span> <span class="o">=</span> <span class="n">ansysinfo</span><span class="o">.</span><span class="n">_make_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                            <span class="c">#self.logger.debug(n + &#39; = &#39; + str(v))</span>
                            <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span> <span class="c">#write new value</span>
                                <span class="n">l</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;%N%&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                                <span class="n">l1</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;%V%&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
                                <span class="n">l2</span> <span class="o">=</span> <span class="s">&#39;!apply &#39;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; to &#39;</span> <span class="o">+</span> \
                                    <span class="s">&#39; keypoint component &#39;</span> <span class="o">+</span> <span class="n">name</span>
                                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">l2</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">l1</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
                                <span class="n">input_cmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;nodes&#39;</span><span class="p">:</span>
                        <span class="c">#self.logger.debug(&#39;node &#39; + name)</span>
                        <span class="c">#import pdb; pdb.set_trace()</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ansysinfo</span><span class="o">.</span><span class="n">nodeinputtypes</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                            <span class="n">n</span> <span class="o">=</span> <span class="n">ansysinfo</span><span class="o">.</span><span class="n">_make_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">print</span> <span class="s">&#39;Exception in gettattr &#39;</span> <span class="o">+</span> <span class="n">n</span>
                                <span class="n">v</span> <span class="o">=</span> <span class="mf">0.0</span>
                            <span class="c">#self.logger.debug(n + &#39; = &#39; + str(v))</span>
                            <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span> <span class="c">#write new value</span>
                                <span class="n">l</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;%N%&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                                <span class="n">l1</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;%V%&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
                                <span class="n">l2</span> <span class="o">=</span> <span class="s">&#39;!apply &#39;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; to &#39;</span> <span class="o">+</span> \
                                    <span class="s">&#39; node component &#39;</span> <span class="o">+</span> <span class="n">name</span>
                                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">l2</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">l1</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
                                <span class="n">input_cmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;global&#39;</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ansysinfo</span><span class="o">.</span><span class="n">globalinputtypes</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                            <span class="n">n</span> <span class="o">=</span> <span class="n">ansysinfo</span><span class="o">.</span><span class="n">_make_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                            <span class="n">initial_v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s">&#39;initial_&#39;</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="n">initial_v</span><span class="p">:</span> <span class="c">#write new value</span>
                                <span class="n">l</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;%N%&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                                <span class="n">l1</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;%V%&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
                                <span class="n">l2</span> <span class="o">=</span> <span class="s">&#39;!apply &#39;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; to &#39;</span> <span class="o">+</span> \
                                    <span class="s">&#39; global component &#39;</span> <span class="o">+</span> <span class="n">name</span>
                                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">l2</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">l1</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
                                <span class="n">input_cmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>


                    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;coordinputtypes&#39;</span><span class="p">:</span>
                        <span class="n">keys</span> <span class="o">=</span> <span class="n">ansysinfo</span><span class="o">.</span><span class="n">coordinputtypes</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                        <span class="n">keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                        <span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ansysinfo</span><span class="o">.</span><span class="n">coordinputtypes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">bnd</span><span class="p">,</span> <span class="n">vvv</span> <span class="ow">in</span> <span class="n">vv</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                            <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">defls</span> <span class="ow">in</span> <span class="n">vvv</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span> <span class="c"># node is node number, delfs is list [UX, UY, UZ]</span>
                                <span class="k">for</span> <span class="n">defl</span><span class="p">,</span> <span class="n">sub</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">defls</span><span class="p">,</span> <span class="n">subs</span><span class="p">):</span>
                                    <span class="k">if</span> <span class="n">defl</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span><span class="p">:</span>
                                        <span class="n">l</span> <span class="o">=</span> <span class="n">sub</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;%N%&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
                                        <span class="n">l1</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;%V%&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">defl</span><span class="p">))</span>
                                        <span class="n">l2</span> <span class="o">=</span> <span class="s">&#39;!apply deflection &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">defl</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; to &#39;</span> <span class="o">+</span> <span class="s">&#39; node &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>  
                                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">l2</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">l1</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
                                        <span class="n">input_cmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>

            <span class="c"># extra_inputs, set elsewhere, get passed through verbatim</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">input_cmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;-------------------------------------</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39; write input done&#39;</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">currdir</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">input_cmds</span>
    <span class="k">def</span> <span class="nf">convert_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span></div>
<div class="viewcode-block" id="ANSYSWrapperBase.convert_units"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase.convert_units">[docs]</a>        <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">__class__</span> <span class="o">==</span> <span class="n">UnitsAttrWrapper</span><span class="p">:</span>

            <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__base_traits__</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">units</span>

            <span class="k">try</span><span class="p">:</span>    
                <span class="n">v</span><span class="o">.</span><span class="n">pq</span><span class="o">.</span><span class="n">convert_to_unit</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;Units are not set for&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s">&quot; in &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span>

            <span class="n">value</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">pq</span><span class="o">.</span><span class="n">value</span>            
            <span class="k">return</span> <span class="n">value</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>


    <span class="k">def</span> <span class="nf">write_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="ANSYSWrapperBase.write_solution"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase.write_solution">[docs]</a>        <span class="sd">&quot;&quot;&quot;Write solution commands file self.solutionfile.&quot;&quot;&quot;</span>
        <span class="n">currdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">needrun</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">workingdir</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solutionfile</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">ioe</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&#39;Error opening solutionfile file &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">solutionfile</span>
                <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">ioe</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">return</span> <span class="bp">False</span>

            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution</span><span class="p">():</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">);</span>
            <span class="n">needrun</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">currdir</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">needrun</span>

    <span class="k">def</span> <span class="nf">process_output_from_fea_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feaModel</span><span class="p">):</span></div>
<div class="viewcode-block" id="ANSYSWrapperBase.process_output_from_fea_model"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase.process_output_from_fea_model">[docs]</a>        <span class="sd">&quot;&quot;&quot;Override if necessary in subclass.&quot;&quot;&quot;</span>
        <span class="n">nodeLabels</span> <span class="o">=</span> <span class="n">feaModel</span><span class="o">.</span><span class="n">nodeLabels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;nodeLabels: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nodeLabels</span><span class="p">))</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">feaModel</span><span class="o">.</span><span class="n">nodeMap</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;component: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">component</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodeLabels</span><span class="p">):</span>
                <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">feaModel</span><span class="o">.</span><span class="n">nodeMap</span><span class="p">[</span><span class="n">component</span><span class="p">]:</span>
                    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span> 
                <span class="n">value_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_value_list</span><span class="p">(</span><span class="n">component</span><span class="o">+</span><span class="s">&#39;_&#39;</span><span class="o">+</span><span class="n">item</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
                <span class="n">outputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">outputs</span>

    <span class="k">def</span> <span class="nf">read_output</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="ANSYSWrapperBase.read_output"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase.read_output">[docs]</a>        <span class="sd">&quot;&quot;&quot;Read output file.</span>
<span class="sd">           Uses self.components.&quot;&quot;&quot;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">workingdir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39;.py&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39; read feaModel from &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fname</span><span class="p">))</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
            <span class="k">exec</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="n">feaModel</span> <span class="o">=</span> <span class="n">FeaPropertiesInPythonFormat</span><span class="p">()</span>    
            <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_output_from_fea_model</span><span class="p">(</span><span class="n">feaModel</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">ioe</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39; Error trying to read file &#39;</span> <span class="o">+</span> <span class="n">fname</span>
            <span class="k">print</span> <span class="n">s</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ioe</span><span class="p">))</span>
            <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">ioe</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39; exception in read_output&#39;</span>
            <span class="k">print</span> <span class="n">s</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">outputs</span>

    <span class="k">def</span> <span class="nf">_log_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">vals</span><span class="p">):</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;   &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;      &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lbl</span><span class="p">))</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;      &#39;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; &#39;</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;      &#39;</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">picklecache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<div class="viewcode-block" id="ANSYSWrapperBase.picklecache"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase.picklecache">[docs]</a>        <span class="n">picklefile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cachefile</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span> <span class="n">picklefile</span><span class="p">)</span>
        <span class="n">picklefile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="ANSYSWrapperBase.execute"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase.execute">[docs]</a>        <span class="sd">&quot;&quot;&quot; Write input, signal ansys to run, read output &quot;&quot;&quot;</span>
        <span class="k">print</span> <span class="s">&#39;ANSYSWrapperBase: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39;: execute start&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;ANSYSWrapperBase: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39;: execute start&#39;</span><span class="p">)</span>    
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ok</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39; execute&#39;</span><span class="p">)</span>
            <span class="n">input_cmds</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">write_input</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_inputs</span><span class="p">()</span> <span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">input_cmds</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39; found in cache &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">input_cmds</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">output_tuple</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">input_cmds</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">output_tuple</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">o</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                <span class="c">#get value from cache</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_solution</span><span class="p">()</span>
                <span class="n">ok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prep7</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">post</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39; ok after run&#39;</span>
                    <span class="k">print</span> <span class="n">s</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                    <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_output</span><span class="p">()</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39; after read_output&#39;</span>
                    <span class="k">print</span> <span class="n">s</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  
                    <span class="k">if</span> <span class="n">outputs</span> <span class="o">&lt;&gt;</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">input_cmds</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">picklecache</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39; not ok after run&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                    <span class="k">print</span> <span class="n">s</span>
        <span class="k">print</span> <span class="s">&#39;ANSYSWrapperBase: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39;: execute end&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;ANSYSWrapperBase: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span> <span class="o">+</span> <span class="s">&#39;: execute end&#39;</span><span class="p">)</span>    

    <span class="k">def</span> <span class="nf">prep7</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="ANSYSWrapperBase.prep7"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase.prep7">[docs]</a>        <span class="sd">&quot;&quot;&quot;entry point for derived wrappers to add customization to the /PREP7 section&quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">options</span>

    <span class="k">def</span> <span class="nf">solution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="ANSYSWrapperBase.solution"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase.solution">[docs]</a>        <span class="sd">&quot;&quot;&quot;entry point for derived wrappers to add customization to the /SOL section&quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;solve </span><span class="se">\n</span><span class="s">&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">options</span>

    <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="ANSYSWrapperBase.post"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase.post">[docs]</a>        <span class="sd">&quot;&quot;&quot;entry point for derived wrappers to add customization to the /POST section&quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">options</span>

    <span class="k">def</span> <span class="nf">extra_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="ANSYSWrapperBase.extra_inputs"><a class="viewcode-back" href="../../srcdocs.html#ansyswrapper.ansyswrapper.ANSYSWrapperBase.extra_inputs">[docs]</a>        <span class="sd">&quot;&quot;&quot;entry point so the child class can add extra input to the \*.inp file for Ansys&quot;&quot;&quot;</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">inputs</span>


    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
        <span class="c">#TO_CHECK:  this doesn&#39;t seem to get called....</span>
        <span class="k">print</span> <span class="s">&#39;DELETING AnsysWrapper &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span> <span class="c"># pragma: no cover         </span></div>

    <span class="n">testdir</span> <span class="o">=</span> <span class="s">&#39;C:/Projects1/Louis/beamfiles/&#39;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;beam1_twoLoads&#39;</span>
    <span class="n">ar</span> <span class="o">=</span> <span class="n">ANSYSRunner</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">testdir</span><span class="p">,</span> <span class="n">logger_name</span> <span class="o">=</span> <span class="s">&#39;MSI&#39;</span><span class="p">)</span>
    <span class="n">aw</span> <span class="o">=</span> <span class="n">ANSYSWrapperBase</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="n">ar</span><span class="p">,</span> <span class="n">testdir</span> <span class="o">+</span> <span class="s">&#39;beam1_twoLoads.db&#39;</span><span class="p">,)</span>

    <span class="k">print</span> <span class="p">(</span> <span class="n">ar</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span> <span class="p">)</span>
    <span class="n">ar</span><span class="o">.</span><span class="n">init_ansys</span><span class="p">(</span><span class="n">aw</span><span class="o">.</span><span class="n">prep7</span><span class="p">(),</span> <span class="n">aw</span><span class="o">.</span><span class="n">solution</span><span class="p">(),</span> <span class="n">aw</span><span class="o">.</span><span class="n">post</span><span class="p">())</span>
<span class="c">#    aw.execute()</span>

    <span class="n">aw</span><span class="o">.</span><span class="n">write_input</span><span class="p">()</span>
    <span class="n">aw</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">aw</span><span class="o">.</span><span class="n">my_name</span><span class="p">,</span> <span class="n">aw</span><span class="o">.</span><span class="n">prep7</span><span class="p">(),</span> <span class="n">aw</span><span class="o">.</span><span class="n">solution</span><span class="p">(),</span> <span class="n">aw</span><span class="o">.</span><span class="n">post</span><span class="p">())</span>


    <span class="n">ar</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">ansyswrapper 0.1.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013 Mechanical Solutions Inc..
      Last updated on Oct 30, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>